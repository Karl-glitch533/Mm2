local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Player = Players.LocalPlayer
local Mouse = Player:GetMouse()
local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")

-- Create Main GUI Frame
MainFrame.Size = UDim2.new(0, 300, 0, 400)
MainFrame.Position = UDim2.new(0.5, -150, 0.5, -200)
MainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
MainFrame.Visible = true
MainFrame.Parent = ScreenGui

-- Add a corner for the main frame
local mainFrameCorner = Instance.new("UICorner")
mainFrameCorner.CornerRadius = UDim.new(0, 10)
mainFrameCorner.Parent = MainFrame

-- Create Toggle Button
local toggleGuiButton = Instance.new("TextButton")
toggleGuiButton.Size = UDim2.new(0, 80, 0, 30)
toggleGuiButton.Position = UDim2.new(0, 10, 0.5, -15)  -- Positioned on the left side
toggleGuiButton.Text = "Toggle GUI"
toggleGuiButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
toggleGuiButton.TextColor3 = Color3.fromRGB(0, 255, 127)
toggleGuiButton.Font = Enum.Font.Gotham
toggleGuiButton.TextSize = 14
toggleGuiButton.Parent = ScreenGui

-- Rounded corners for Toggle Button
local toggleButtonCorner = Instance.new("UICorner")
toggleButtonCorner.CornerRadius = UDim.new(0, 8)
toggleButtonCorner.Parent = toggleGuiButton

-- Create ESP Toggle Button
local espButton = Instance.new("TextButton")
espButton.Size = UDim2.new(0, 80, 0, 30)
espButton.Position = UDim2.new(0, 100, 0.5, -15)  -- Next to toggle button
espButton.Text = "Toggle ESP"
espButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
espButton.TextColor3 = Color3.fromRGB(0, 255, 127)
espButton.Font = Enum.Font.Gotham
espButton.TextSize = 14
espButton.Parent = ScreenGui

local espEnabled = false

-- Create Auto-Shoot Button
local shootMurderButton = Instance.new("TextButton")
shootMurderButton.Size = UDim2.new(0, 100, 0, 30)
shootMurderButton.Position = UDim2.new(0, 200, 0.5, -15)  -- Next to ESP button
shootMurderButton.Text = "Shoot Murder"
shootMurderButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
shootMurderButton.TextColor3 = Color3.fromRGB(0, 255, 127)
shootMurderButton.Font = Enum.Font.Gotham
shootMurderButton.TextSize = 14
shootMurderButton.Parent = ScreenGui

-- Function to Toggle GUI Visibility
toggleGuiButton.MouseButton1Click:Connect(function()
    MainFrame.Visible = not MainFrame.Visible
end)

-- Function to Enable/Disable ESP
espButton.MouseButton1Click:Connect(function()
    espEnabled = not espEnabled
    if espEnabled then
        espButton.Text = "ESP ON"
        -- Start ESP
        for _, player in ipairs(Players:GetPlayers()) do
            if player ~= Player then
                local highlight = Instance.new("Highlight", player)
                highlight.FillColor = Color3.new(1, 0, 0) -- Default to red
                highlight.OutlineColor = Color3.new(1, 1, 1) -- White outline

                -- Color based on player role
                if player:FindFirstChild("PlayerStats") then
                    local role = player.PlayerStats.Role.Value -- Assuming this property exists
                    if role == "Murderer" then
                        highlight.FillColor = Color3.new(1, 0, 0) -- Red for Murderer
                    elseif role == "Sheriff" then
                        highlight.FillColor = Color3.new(0, 0, 1) -- Blue for Sheriff
                    elseif role == "Innocent" then
                        highlight.FillColor = Color3.new(0, 1, 0) -- Green for Innocent
                    end
                end
            end
        end
    else
        espButton.Text = "Toggle ESP"
        -- Remove ESP
        for _, player in ipairs(Players:GetPlayers()) do
            if player ~= Player then
                local highlight = player:FindFirstChildOfClass("Highlight")
                if highlight then
                    highlight:Destroy()
                end
            end
        end
    end
end)

-- Function to Auto-Shoot Murder
local autoShootEnabled = false
local shootButton

shootMurderButton.MouseButton1Click:Connect(function()
    autoShootEnabled = not autoShootEnabled
    if autoShootEnabled then
        shootMurderButton.Text = "Auto Shooting"
        -- Create an Auto-Shoot Button
        shootButton = Instance.new("TextButton")
        shootButton.Size = UDim2.new(0, 100, 0, 30)
        shootButton.Position = UDim2.new(1, -110, 0.5, -15)  -- Positioned on the right side
        shootButton.Text = "Shooting..."
        shootButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
        shootButton.TextColor3 = Color3.fromRGB(0, 255, 127)
        shootButton.Font = Enum.Font.Gotham
        shootButton.TextSize = 14
        shootButton.Parent = ScreenGui

        -- Auto-shoot logic (Example)
        while autoShootEnabled do
            -- Check if player is a Murderer
            if Player:FindFirstChild("PlayerStats") and Player.PlayerStats.Role.Value == "Murderer" then
                -- Find a target
                for _, target in ipairs(Players:GetPlayers()) do
                    if target ~= Player and target:FindFirstChild("PlayerStats") then
                        -- Shooting Logic Here (placeholder)
                        -- You can use RemoteEvents to trigger actual shooting in the game
                        print("Shooting", target.Name)
                        wait(1) -- Wait time between shots
                        break -- Remove break if you want to shoot at all targets
                    end
                end
            end
            wait(0.1) -- Control the frequency of the shooting check
        end
    else
        shootMurderButton.Text = "Shoot Murder"
        if shootButton then
            shootButton:Destroy() -- Remove the auto-shoot button when not active
        end
    end
end)

ScreenGui.Parent = Player.PlayerGui
